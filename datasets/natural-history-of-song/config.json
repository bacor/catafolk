{
    "dataset_id": "natural-history-of-song",
    "sources": {
        "file": {
            "type": "file",
            "file_pattern": "data/Transcriptions/xml_raw/*.xml"
        },
        "meta": {
            "type": "csv",
            "path": "data/Datasets/NHSDiscography_Metadata.csv",
            "id_field": "song"
        },
        "transcription_features": {
            "type": "csv",
            "path": "data/Datasets/NHSDiscography_TranscriptionFeatures.csv",
            "id_transformations": [
                [["to_int", "format"], "song", "id", [{}, {"pattern": "NHSDiscography-{:0>3}"}]]
            ]
        }
    },
    "meta_fields_conversion": {
        "NHSDiscography_Metadata_citation": {
            "type": "regex",
            "pattern": "(\"+([^\"]+)\"+( +\\[([^\\]]+)\\])?\\.? ([^\\.]+)\\.( ([^:]+): ([^\\(]+)\\(([^\\)]+)\\))?)",
            "groups": [
                "source", 
                "title", 
                null,
                "source_song_num",
                "source_title",
                null,
                "source_address",
                "source_publisher",
                "source_date"
            ]
        }
    },
    "transformations": [
        ["rename", "file.cf_checksum", "checksum"],
        ["rename", "file.cf_path", "path"],
        ["rename", "file.cf_format", "format"],
        ["constant", "dataset_id", "natural-history-of-song"],
        ["rename", "meta.type", "genre"],
        ["rename", "meta.culture", "culture"],
        ["rename", "meta.location_modern", "location"],
        ["rename", "meta.latitude", "latitude"],
        ["rename", "meta.longitude", "longitude"],
        ["rename", "meta.year", "collection_date"],
        ["rename", "meta.permalink", "source_url"],
        ["rename", "transcription_features.range", "ambitus"],
        {
            "operation": "extract_groups",
            "inputs": ["meta.citation"],
            "outputs": [
                "source",
                "title",
                "source_song_num",
                "source_title",
                "source_address",
                "source_publisher",
                "source_date"
            ],
            "params": {
                "pattern": "\"+([^\"]+)\"+( +\\[([^\\]]+)\\])?\\.? ([^\\.]+)\\.( ([^:]+): ([^\\(]+)\\(([^\\)]+)\\))?",
                "groups": [0, 1, 3, 4, 6, 7, 8]
            }
        }
    ],
    "corrections": {
        "NHSDiscography-094": {
            "title": "Angi: Love song to a married woman",
            "source_song_num": "Disc 1, Side B, Track 10",
            "source_title": "On The Demonstration Collection of E.M. von Hornbostel and the Berlin Phonogramm-Archiv [LP]",
            "source_address": "New York",
            "source_publisher": "Folkways Records",
            "source_date": "1963"
        }
    }
}