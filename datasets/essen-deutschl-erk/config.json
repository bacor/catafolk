{
    "dataset_id": "essen-deutschl-erk",
    "sources": [{
        "name": "file",
        "type": "file",
        "file_pattern": "data/*.krn",
        "file_options": {
            "encoding": "ISO-8859-1"
        }
    }],
    "transformations": [
        ["rename", "file.cf_checksum", "checksum"],
        ["rename", "file.cf_path", "path"],
        ["rename", "file.cf_format", "format"],
        ["constant", "dataset_id", "essen-deutschl-erk"],
        ["constant", "has_music", true],
        ["constant", "has_lyrics", false],
        ["rename", "file.YEM", "copyright"],
        ["rename", "file.AMT", "metric_classification"],
        ["rename", "file.EED", "encoder"],
        ["rename", "file.EEV", "version"],
        ["rename", "file.AGN", "genre"],
        ["rename", "file.ARE", "location"],
        ["titlecase", "file.OTL", "title"],
        [
            "format", "path", "preview_url", 
            {"pattern": "https://verovio.humdrum.org/?file=essen/europa/deutschl/erk/{}"}
        ],
        [
            "format", "path", "url", 
            {"pattern": "https://kern.humdrum.org/cgi-bin/ksdata?file={}&l=essen/europa/deutschl/erk&format=kern"}
        ],
        {
            "operation": "extract_groups",
            "inputs": ["file.SCT"],
            "outputs": ["catalogue_num", "source_song_num", "source_song_num_int"],
            "params": {
                "pattern": "E0*((\\d+)(\\w+)?)",
                "groups": [0, 1, 2]
            },
            "regex_test": "https://regex101.com/r/By53if/2"
        },
        {
            "operation": "map_numeric_bins",
            "inputs": ["source_song_num_int"],
            "outputs": ["source_key"],
            "params": {
                "bins": [
                    { "min": 0, "max": 220, "value": "erk1893liederhort1" },
                    { "min": 221, "max": 1060, "value": "erk1893liederhort2"},
                    { "min": 1061, "max": 2175, "value": "erk1893liederhort3"}
                ]
            }
        }
    ]
}